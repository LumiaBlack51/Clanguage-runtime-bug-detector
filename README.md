# C Safety Scanner

一个基于启发式分析的 C 代码安全扫描工具，用于检测常见的编程错误。

## 功能特性

- **未初始化变量检测**: 检测变量在初始化前被使用的情况
- **野指针检测**: 检测未初始化指针的解引用操作
- **存储类说明符支持**: 支持 `static`、`const`、`extern` 等存储类说明符的识别
- **头文件拼写检查**: 检测非标准头文件名称
- **函数参数识别**: 正确识别函数参数，避免误报

## 安装与使用

### 依赖安装
```bash
npm install
```

### 编译
```bash
npm run compile
```

### 基本使用
```bash
# 扫描指定目录
node ./out/cli.js <目录路径>

# 扫描测试用例
npm run scan:buggy    # 扫描错误用例
npm run scan:correct  # 扫描正确用例

# 生成报告
npm run report:buggy
npm run report:correct
```

### VS Code 扩展
```bash
# 打包扩展
npm run vsce:package
```

安装生成的 `.vsix` 文件到 VS Code 中，即可使用图形界面进行扫描。

## 技术架构

- **启发式解析**: 使用基于正则表达式的行级解析，稳定可靠
- **分段哈希表**: 使用分段哈希表优化变量查找性能
- **作用域管理**: 支持全局和函数局部作用域的变量管理
- **类型识别**: 支持基本类型和存储类说明符的组合识别

## 检测规则

1. **未初始化变量使用**: 检测变量在赋值前被使用
2. **野指针解引用**: 检测未初始化指针的 `*p`、`p->`、`p[i]` 操作
3. **头文件拼写**: 检测非标准 C 库头文件名称
4. **函数参数**: 正确识别函数参数，避免误报

## 测试用例

项目包含完整的测试用例集：
- `tests/graphs/buggy/`: 包含各种错误的测试用例
- `tests/graphs/correct/`: 包含正确代码的测试用例

## 性能指标

当前版本的性能指标：
- **Precision**: 64.7%
- **Recall**: 50%
- **F1**: 56.4%

## 开发历史

- 移除了有问题的 tree-sitter 依赖
- 优化了启发式解析算法
- 增强了存储类说明符支持
- 改进了函数参数识别

## 许可证

MIT License